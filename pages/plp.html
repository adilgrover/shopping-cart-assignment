<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles/plpStyles.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="bodyContainer">
      <div class="pageContainer">
        <div class="header">
          <div class="logo"><img src="../static/images/logo.png" /></div>

          <div class="tabs">
            <a href="./index.html">Home</a>
            <a href="./plp.html">Products</a>
          </div>
          <div class="cart">
            <div class="register">
              <a href="./signIn.html">SignIn</a>
              <a href="./register.html">Register</a>
            </div>
            <div class="cartWrapper">
              <img
                alt="cart icon"
                class="cartIcon"
                src="https://raw.githubusercontent.com/gautam-in/shopping-cart-assignment/master/static/images/cart.svg"
              />
              <a href="./cart.html"> cart</a>
            </div>
          </div>
        </div>

        <div class="containerDiv">
          <div class="leftCard">
            <ul class="list">
              <li>Fruits & Vegetables</li>
              <li>Bakery Cakes & Dairy</li>
              <li>Beverages</li>
              <li>Beauty & Hygiene</li>
              <li>Baby Care</li>
            </ul>
          </div>
          <div class="rightWrapper cardContainer">
            <!-- <ul class="cardContainer"></ul> -->
          </div>
        </div>
      </div>
    </div>

    <script>
      let container = document.querySelector(".rightWrapper");
      let state = { categories: [] };
      var items = [];
      var cart = [];
      fetch("../server/products/index.get.json")
        .then((response) => response.json())
        .then((data) => {
          // item.push(...data);
          data.map((el) => {
            items.push(el);
          });
        })
        .catch((error) => console.log(error));
      console.log("item", items);
      setTimeout(() => {
        items?.map((el, index) => {
          const html = `<li class="card">
                  <div class="heading shop-item-title">${el?.name} </div>
              <div><img class="shop-item-image" src=${el?.imageURL} /></div>
             <div> <div class="description">${el?.description}</div>
             <div class="price"> <div class="shop-item-price">MRP Rs${el?.price}</div>
             <button id="myButton"  data-obj=${index} class="explore btn btn-primary shop-item-button"   >Buy Now</button> </div>
            </li>`;
          container.insertAdjacentHTML("afterbegin", html);
        });
        var domClass = document.querySelectorAll(".shop-item-button");
        console.log("domClass", domClass);
        domClass.forEach((b) => {
          b.addEventListener("click", (e) => {
            e.preventDefault();

            // window.location.push();
            if (!cart.length) cart.push(items[b.dataset.obj]);
            else {
              let itemIndex = cart.find(
                (item) => item.id === items[b.dataset.obj].id
              );
              if (!itemIndex) cart.push(items[b.dataset.obj]);
              else {
                let newCart = cart.filter((item) => item.id !== itemIndex.id);
                cart = [
                  ...newCart,
                  {
                    ...items[b.dataset.obj],
                    qty: items[b.dataset.obj].qty + 1,
                  },
                ];
              }
            }
            console.log(cart);
          });
        });
      }, 1000);
    </script>
  </body>
</html>
