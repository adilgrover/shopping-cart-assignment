<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles/plpStyles.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="bodyContainer">
      <div class="pageContainer">
        <div class="header">
          <div class="logo"><img src="../static/images/logo.png" /></div>

          <div class="tabs">
            <a href="./index.html">Home</a>
            <a href="./plp.html">Products</a>
          </div>
          <div class="cart">
            <div class="register">
              <a href="./signIn.html">SignIn</a>
              <a href="./register.html">Register</a>
            </div>
            <div class="cartWrapper">
              <img
                alt="cart icon"
                class="cartIcon"
                src="https://raw.githubusercontent.com/gautam-in/shopping-cart-assignment/master/static/images/cart.svg"
              />
              <a href="./cart.html"> cart</a>
            </div>
          </div>
        </div>
        <select class="product-list-nav-mobile">
          <option>Fruits & Vegetables</option>
          <option>Bakery Cakes & Dairy</option>
          <option>Beverages</option>
          <option>Beauty & Hygiene</option>
          <option>Baby Care</option>
        </select>

        <div class="containerDiv">
          <!-- <div class="leftCard"> -->
          <ul class="product-list-nav">
            <li class="categoryIdentity" data-cat="5b6899953d1a866534f516e2">
              Fruits & Vegetables
            </li>
            <li class="categoryIdentity" data-cat="5b6899123d1a866534f516de">
              Bakery Cakes & Dairy
            </li>
            <li class="categoryIdentity" data-cat="5b675e5e5936635728f9fc30">
              Beverages
            </li>
            <li class="categoryIdentity" data-cat="5b68994e3d1a866534f516df">
              Beauty & Hygiene
            </li>
            <li class="categoryIdentity" data-cat="5b6899683d1a866534f516e0">
              Baby Care
            </li>
          </ul>
          <!-- </div> -->
          <!-- <div class="rightWrapper cardContainer"> -->
          <section class="product-list-main"></section>
          <!-- <ul class="cardContainer"></ul> -->
          <!-- </div> -->
        </div>
      </div>
      <div class="footer">
        Copyrights Â© 2011-2018 Sabka Bazaar Grocery Supplies Pvt. Ltd
      </div>
    </div>

    <script>
      let container = document.querySelector(".product-list-main");
      let state = { categories: [] };
      var items = [];
      var tempItems = [];
      var cart = [];
      var listCategory = document.querySelectorAll(".categoryIdentity");
      console.log("listCategory", listCategory);
      listCategory.forEach((list) => {
        list.addEventListener("click", () => {
          console.log("list", list.dataset.cat);
          console.log("items.....", items);
          tempItems = items.filter((it) => {
            console.log("ittttt", it.category);
            if (it.category == list.dataset.cat) return it;
          });
          console.log("tempItems", tempItems);
        });
      });
      fetch("../server/products/index.get.json")
        .then((response) => response.json())
        .then((data) => {
          // item.push(...data);
          data.map((el) => {
            items.push(el);
          });
          tempItems = [...items];
        })
        .catch((error) => console.log(error));
      console.log("item", items);
      setTimeout(() => {
        tempItems?.map((el, index) => {
          const html = ` <section class ="product-box">
          
                  <h3>${el?.name} </h3>
              <img class=" hide-on-tablet hide-on-mobile" src=${el?.imageURL} />
              <section class="product-container-mobile only-on-mobile">
              <img
              src=${el?.imageURL}
               
                class="hide-on-tablet"
              />
              <section class="product-details-mobile">
                <p>
                  ${el?.description}
                </p>
                <button id="myButton"  data-obj=${index} class="explore btn btn-primary shop-item-button"   >Buy Now</button> 
              </section>
              
            </section>
            <p class="hide-on-tablet hide-on-mobile">
                ${el?.description}
            </p>
            <section class="product-details-tablet hide-on-mobile">
              <img
              src=${el?.imageURL}
             
              />
              <p>
                ${el?.description}
              </p>
            </section>
            <div class="price-cta-section hide-on-mobile">
              <span class="hide-on-tablet">${el?.price}</span>
              <button id="myButton"  data-obj=${index} class="hide-on-tablet explore btn btn-primary shop-item-button"   >Buy Now @ Rs ${el?.price}  </button> 
              <button id="myButton"  data-obj=${index} class="hide-on-desktop explore btn btn-primary shop-item-button"   >Buy Now @ Rs ${el?.price}</button> 
          
            </div>
            
         </div>
           </section> `;
          container.insertAdjacentHTML("afterbegin", html);
        });
        var domClass = document.querySelectorAll(".shop-item-button");

        domClass.forEach((b) => {
          b.addEventListener("click", (e) => {
            e.preventDefault();
            cart = JSON.parse(localStorage.getItem("cartItems"));
            console.log(".......", cart);
            // window.location.push();
            if (cart === null) {
              // localStorage.setItem("cartItems", JSON.stringify(cart || []));
              cart = [];
              cart.push(items[b.dataset.obj]);
            } else {
              let itemIndex = cart.find(
                (item) => item.id === items[b.dataset.obj].id
              );
              if (!itemIndex) cart.push(items[b.dataset.obj]);
              else {
                let newCart = cart.filter((item) => item.id !== itemIndex.id);
                cart = [
                  ...newCart,
                  {
                    ...items[b.dataset.obj],
                    qty: items[b.dataset.obj].qty + 1,
                  },
                ];
              }
            }
            var getItemCart = localStorage.getItem("cartItems");
            localStorage.setItem("cartItems", JSON.stringify(cart));
          });
        });
      }, 1000);
    </script>
  </body>
</html>
<!-- [{"name":"Johnson's Active Kids Shampoo - Shiny Drops With Argan Oil, 100 ml","imageURL":"/static/images/products/baby/shampoo.jpg","description":"A hair care product range specifically for kids aged 2 years and above. This mild shiny drops shampoo formula has been developed to boost natural shine & help reduce frizz, leaving hair silky smooth and healthy looking.","price":95,"stock":50,"category":"5b6899683d1a866534f516e0","sku":"baby-shampoo-100","id":"5b6c75e101a7c3842953089a"},{"name":"Mamypoko Pants Style Diapers - Large, 62 pcs","imageURL":"/static/images/products/baby/mamy.jpg","description":"MamyPoko Pants Extra Absorb is a Pant Style diaper that can be used most comfortably for the baby at night Because of Powerful slim core that can absorb up to 12 hours, it prevents leakage till morning.","price":930,"stock":50,"category":"5b6899683d1a866534f516e0","sku":"baby-mamy-62","id":"5b6c74d101a7c38429530896"},{"name":"Johnson & Johnson Baby skincare wipes, 20 pcs","imageURL":"/static/images/products/baby/wipes.jpg","description":"Johnsons Baby wipes gently cleanse and care for babys delicate skin. As mild as pure water, they can be used safely all over the body, even around eyes.","price":70,"stock":50,"category":"5b6899683d1a866534f516e0","sku":"baby-wipes-20","id":"5b6c750701a7c38429530897"},{"name":"TRESemme Shampoo - Keratin Smooth With Argan Oil, 580 ml ","imageURL":"/static/images/products/beauty-hygiene/shampoo.jpg","description":"For the first time, at TRESemme , Our Professional combines luxurious ingredients to give you gorgeously smoother shiny hair every day , infused with keratin protein and lightweight argan oil , our advanced keratin smooth system gently nourishes hair and controls frizz for up to 3 days.","price":410,"stock":50,"category":"5b68994e3d1a866534f516df","sku":"bh-tresemme-580","id":"5b6c71a101a7c38429530891"},{"name":"Red Label Tea, 500 gm Carton","imageURL":"/static/images/products/beverages/red-label.jpg","description":"Brooke Bond Red Label is one of Indias largest selling packaged tea brands. Brooke Bond Red Label Tea is a blend CTC tea with best quality leaves.","price":205,"stock":50,"category":"5b675e5e5936635728f9fc30","sku":"bev-red-label-500","id":"5b6c6f8301a7c3842953088d"}] -->
